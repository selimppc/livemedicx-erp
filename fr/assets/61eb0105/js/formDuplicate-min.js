/**
 * Created by edoardo849 - <> on 9/14/12 10:51 AM.
 */var formDuplicate={triggerClass:".btn-table-duplicate",devMode:!1,init:function(){$(document).on("click",formDuplicate.triggerClass,function(e){formDuplicate.devMode&&console.log("Click detected");e.preventDefault();var t=$(this),n=t.data("action"),r=t.data("parent"),i=$("table"+r+" tbody tr"),s=i.size(),o=t.data("mode"),u=t.data("log");formDuplicate.devMode&&console.log("Action: "+n);if(n=="duplicate")formDuplicate.duplicateRow(o,r,s,i);else{if(n!="delete"){formDuplicate.devMode&&console.log("Error: no action detected");return!1}formDuplicate.deleteRow(t,s,u)}});$(document).on("click",".delete",function(e){e.preventDefault()})},duplicateRow:function(e,t,n,r){formDuplicate.devMode&&console.log("Mode: "+e);var i=$(r).filter(":last-child");i.clone().insertAfter(i);$("table"+t+" tbody tr:last td").find("input, select").each(function(){var t=$(this);if(t.attr("name")){var r=t.attr("name");r=r.replace(/(\d+)/,function(t){var r=e=="update"?"new-":null;return r+n});t.attr("name",r)}if(t.attr("id")){var i=t.attr("id");i=i.replace(/(\d+)/,function(e){return n});t.attr("id",i)}})},deleteRow:function(e,t,n){if(t>1){e.parent().parent().remove();if(e.hasClass("ajaxDelete")){formDuplicate.devMode&&console.log("loading ajax Delete");$.ajax({type:"POST",url:e.data("url"),dataType:"json",success:function(e){$(n).html(e.message)}})}}}};$(function(){formDuplicate.init()});